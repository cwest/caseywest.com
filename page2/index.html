<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>The consensus-seeking architect.</title>
<meta name="description" content="It might get better. It might not, though.">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://caseywest.com/images/feature/lights.jpg">

<meta name="twitter:title" content="The consensus-seeking architect.">
<meta name="twitter:description" content="It might get better. It might not, though.">
<meta name="twitter:creator" content="@caseywest">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="The consensus-seeking architect.">
<meta property="og:description" content="It might get better. It might not, though.">
<meta property="og:url" content="http://caseywest.com/page2/index.html">
<meta property="og:site_name" content="The consensus-seeking architect.">





<link rel="canonical" href="http://caseywest.com/page2/">
<link href="http://caseywest.com/feed.xml" type="application/atom+xml" rel="alternate" title="The consensus-seeking architect. Feed">
<link rel="author" href="https://google.com/+CaseyWest412?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://caseywest.com/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic|Source+Code+Pro" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://caseywest.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 32x32 -->
<link rel="shortcut icon" href="http://caseywest.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://caseywest.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://caseywest.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://caseywest.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://caseywest.com/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://caseywest.com/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://caseywest.com/images/avatar.jpg" alt="Casey West photo" class="author-photo">
					<h4>Casey West</h4>
					<p>I have a lot to say.</p>
				</li>
				<li><a href="http://caseywest.com/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				
				<li>
					<a href="http://twitter.com/caseywest"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://github.com/cwest"><i class="fa fa-github"></i> GitHub</a>
				</li>
				<li>
					<a href="http://angel.co/caseywest"><i class="fa fa-angellist"></i> AngelList</a>
				</li>
				<li>
					<a href="http://linkedin.com/in/caseywest"><i class="fa fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://facebook.com/caseywest"><i class="fa fa-facebook"></i> Facebook</a>
				</li>
				<li>
					<a href="https://google.com/+CaseyWest412"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				
				<li>
					<a href="http://instagram.com/caseyrwest"><i class="fa fa-instagram"></i> Instagram</a>
				</li>
				<li>
					<a href="http://www.flickr.com/photos/caseywest"><i class="fa fa-flickr"></i> Flickr</a>
				</li>
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://caseywest.com/posts/">All Posts</a></li>
				<li><a href="http://caseywest.com/tags/">All Tags</a></li>
			</ul>
		</li>
		
	    
	        
	    
	    <li><a href="http://caseywest.com/resume" >Résumé</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="http://caseywest.com/images/feature/lights.jpg" alt="">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>The consensus-seeking architect.</h1>
      <h2></h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-04-19T00:00:00-04:00"><a href="http://caseywest.com/technical-phone-screen-howto/">April 19, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://caseywest.com/about/" title="About Casey West">Casey West</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~6 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://caseywest.com/technical-phone-screen-howto/" rel="bookmark" title="Technical Phone Screen HOWTO" itemprop="url">Technical Phone Screen HOWTO</a></h1>
    
  </header>
  <div class="entry-content">
    <p>You have 30 minutes to guess at the capability and fit of an incoming candidate. How do you do that? You have to assess a few key areas quickly.</p>

<p>Here are my tips for the person conducting the screening, written from the perspective of the inner monologue I have when I do phone screens.</p>

<h2 id="preparation">Preparation</h2>

<p>Skim the resume but mostly ignore it. If a recruiter was involved it's been re-arranged and re-worded to match keywords in your job posting anyway<sup id="fnref:resume"><a href="#fn:resume" class="footnote">1</a></sup>.</p>

<h2 id="opening-questions">Opening Questions</h2>

<blockquote>
  <p>On your most recent project, which areas did you focus on and contribute to, and <strong>what did you have the most fun with?</strong></p>
</blockquote>

<p>I'm not asking you to read your resume to me. I've seen it (and mostly ignored it). What I'm looking for here is some technical detail of your contribution. Can you articulate what you actually do? I'm technical, and you're going to be working with me all the time, so I want to hear you explain your work so I can understand it.</p>

<p>Even more importantly, hopefully you have enjoyed <em>some</em> aspect of this project. Hopefully enough to tell me about it.</p>

<blockquote>
  <p><strong>Why <code>$company_i_work_for</code>?</strong></p>
</blockquote>

<p>I want you to have at least a passing interest in our company. If it's just, <em>"my recruiter told me you had an opening"</em> I'm much less interested in you. Do you know what we do? Have you at least seen our website?</p>

<h2 id="continued-education">Continued Education</h2>

<blockquote>
  <p><strong>How do you keep up to date with the software landscape?</strong></p>
</blockquote>

<p>Do you read books or blogs, or subscribe to JavaScript Weekly? Do you listen to podcasts? If you don't show any interest in keeping yourself up to date this won't go well, because it means you'll allow our software to become stale, too. You don't need to be on the bleeding edge or anything, but please have read something related to your work recently.</p>

<blockquote>
  <p><strong>What is your favorite open source project?</strong> Anything is valid, from a library to a framework to something bigger.</p>
</blockquote>

<p>This is two-fold. First, I have a bias for open source and I want to hire for that bias. I have a strong bias for building software on top of excellent pre-existing work. <a href="http://en.wikipedia.org/wiki/Not_invented_here">Not Invented Here (NIH) syndrome</a> is bad news and I don't want to hire for it.</p>

<p>Second, something brings you joy in the work you do, right? At some point you've used a tool and been like, "This is the beset thing in the world!" For me that tool is <a href="https://github.com/erkin/ponysay">ponysay</a>, obviously.</p>

<h2 id="testing">Testing</h2>

<blockquote>
  <p><strong>How do you test your current project?</strong> Do you use BDD? Do you use CI? What's your preferred testing tool?</p>
</blockquote>

<p>Even if your current project has no tests, I want to hear you be unhappy about that. I want you to know what BDD means, and CI, and use them (or want to use them). Nearly every software context has multiple testing tools to choose from. JavaScript has QUnit, Jasmine, Mocha, and others. Which one do you prefer and why? Details mean you aren't reciting the manual.</p>

<p>I'll be more specific on this one, because it trips up the folks who screen candidates and love testing: <strong>it isn't the candidate's fault if their company doesn't write automated tests so don't hold that against them.</strong></p>

<h2 id="technical-knowledge">Technical Knowledge</h2>

<blockquote>
  <p><strong>What's your favorite feature of <code>$language_or_framework_you_have_used</code>?</strong> What's your least favorite?</p>
</blockquote>

<p><em>This question can use information gained from the resume, their recent project at work, or their favorite open source project.</em></p>

<p>You should have answers to both. Something is good and something is bad, and I want to hear your opinion. Hopefully I'll even learn something new. If I disagree with you that'll be an interesting conversation for a couple minutes as we debate.</p>

<blockquote>
  <p><strong>Have you worked with <code>$language_or_framework_we_are_hiring_for</code>?</strong> Tell me about that.</p>
</blockquote>

<p>If you've already convinced me you're a polyglot with an open, curious mind, this question isn't as critical but it's still important. I will dig into the details with you about this a bit, and explore what you've been exposed to. This is something I know well, and I'll share with you some of our real challenges in this part of the conversation.</p>

<p>What I'm hoping for is that when I share some of our challenges you have ideas, or questions, or both about how we're addressing them. This is particularly relevant to me, for this job, and it's your primary opportunity to convince me you can help.</p>

<h2 id="tooling">Tooling</h2>

<blockquote>
  <p><strong>What's your favorite <code>git</code> feature?</strong></p>
</blockquote>

<p>I want you to know of git. You don't have to prefer it, but you should know of it. If you have only heard of it and had no exposure I'm sure something piqued your interest.</p>

<p>My favorite is the <code>git commit --fixup; git rebase -i --autosquash</code> combo. If you have used SVN I'm sure you can at least tell me better merging is something you want?</p>

<h2 id="development-process">Development Process</h2>

<blockquote>
  <p><strong>Have you worked on a software team recently? How was that?</strong></p>
</blockquote>

<p>Working on a team is essential. Having some experience means you're more likely to fit into our culture. If you've spent the last five years in a silo it may be hard to adjust to a highly collaborative environment.</p>

<blockquote>
  <p>Are you comfortable with agile software development? <strong>What does 'agile' mean to you?</strong></p>
</blockquote>

<p>Everyone is likely to say yes to the first question. I'm more interested in the answer to the second.</p>

<blockquote>
  <p>We use code review heavily as part of the development process. <strong>Are you comfortable with transparent, professional critique of your work?</strong> Are you comfortable giving it, too?</p>
</blockquote>

<p>This is important to us. Part of working on a team, and working with agility, is being highly collaborative and open to exploring ideas. Hesitation in response is ok, because I'm telling you we will criticize your work. However, I'm <em>not</em> telling you we will criticize <em>you</em>. I need to know you understand the difference.</p>

<h2 id="closing-questions">Closing Questions</h2>

<blockquote>
  <p><strong>What do you want to do next?</strong> Obviously you're looking for a new gig, so what is it you <em>want</em> to be doing?</p>
</blockquote>

<p>I'm looking for some kind of interest in what you do all day. Enough that you have an idea of what you'd like to be doing next. Do you want to do DevOps? Management? Become a Senior-level developer? Learn Ruby?</p>

<p>If you can't come up with anything then you haven't thought about it. Maybe you're going through the motions of finding a new job. Maybe you're just trying to leave a toxic, disgusting culture. That's OK. Sometimes the answer to this question is, <em>"I want to do the same thing I'm doing now, which I'm great at, for a new company."</em></p>

<blockquote>
  <p><strong>Do you have any questions for me?</strong></p>
</blockquote>

<p>Please ask me something, anything. If you have zero questions you aren't really that interested in working with me. There's no way I satisfied every curiosity in this short phone call.</p>

<div class="footnotes">
  <ol>
    <li id="fn:resume">
      <p>I am sad about this advice because I'm actually quite happy with <a href="/resume/">my resume</a> as a piece of writing. <a href="#fnref:resume" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-04-12T00:00:00-04:00"><a href="http://caseywest.com/a-call-for-more-tech-leadership/">April 12, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://caseywest.com/about/" title="About Casey West">Casey West</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~8 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://caseywest.com/a-call-for-more-tech-leadership/" rel="bookmark" title="A Call for More Tech Leadership" itemprop="url">A Call for More Tech Leadership</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Don't promote your most talented technologists into people management. Promote them into technical leadership roles instead. You'll keep happy, engaged leaders and avoid the perils of the <a href="http://en.wikipedia.org/wiki/Peter_Principle">Peter Principle</a>.</p>

<p>It's a common policy in hierarchical organizations to promote top performers into people management. Your best programmer comes up with great ideas, the team listens to her, she can fix anything. It's review time and what happens? She's offered a job in management. What are her new responsibilities? Paperwork, reviews, operational alignment summits, budgets. How much code is she writing now? Not much and she's probably miserable.</p>

<blockquote>
  <p>"I don't want to stop coding." — Almost every good programmer, ever.</p>
</blockquote>

<figure>
    <img src="/images/for-posts/boss.jpg" alt="A giant cup of I'm the fucking boss." />
    <figcaption>
        This was a Christmas present from a member of my team in 2014.
    </figcaption>
</figure>

<p>There's another alternative. Technical leadership. Here are some common tech leadership roles:</p>

<dl>
  <dt>Lead Engineer</dt>
  <dd>You're coding everyday and helping others to code better, too. You have deep experience with the tools and technologies, as well as the problem domain, and you use that to inform internal system design. You keep the code healthy.</dd>
  <dt>Software Architect</dt>
  <dd>You're designing the story arc of how this software fits into its problem domain. You have visibility into the long-term plans for the software, and strong technical skills to work with engineering to build something that keeps the software focused. You keep the software healthy.</dd>
  <dt>CTO</dt>
  <dd>The most senior architect. You know what every product line is aiming for. You know how it fits into the long-term story of the product and the industry. You share this insight with your architects and leads to give them vital context for making great choices. You keep the company healthy.</dd>
</dl>

<h2 id="this-is-the-intersection-of-technology-and-people">This is the intersection of technology and people.</h2>

<p><span class="pullquote-right" data-pullquote="You&apos;re not managing people: you&apos;re leading them.">
People are at the heart of tech leadership roles. It's a socio-technical role, a mix of people and technology. <a href="/your-software-is-made-of-people/">Hacking on one and not the other will cause the performance of both to suffer.</a> This is the critical glue missing from most engineering organizations where engineers are promoted to managers. This is where technical leadership plays its key role. You're not managing people: you're leading them.
</span></p>

<p>Why is there a gap? Because newly-promoted managers now have too many jobs. Promoting a tech lead into a manager forces them into the problem of having too many roles. Their boss is expecting them to be a full-time people manager, but their team depends on their technical leadership. They'll either have to choose one or do both poorly, for lack of time, which will eventually force their hand into choosing people management. Again, because <em>their</em> boss is expecting them to do that role. Now there's a void in technical leadership.</p>

<p>In a healthy organization the tech lead (lets say a Principal Architect) and the people manager are a powerful pair. When they're working together the people on their team are taken care of at every level. The team is comfortable because they know what to build and why, and that they're building on the right path. They're also getting the individual attention of their manager.</p>

<h2 id="tech-leadership-is-a-force-multiplier">Tech leadership is a <a href="https://en.wikipedia.org/wiki/Force_multiplication">force multiplier</a>.</h2>

<p>As a technical leader you aren't always writing code. If you're a recognized leader chances are you already know that. You spend a lot of time helping others. Teaching, mentoring, reviewing code, standing at the whiteboard and explaining the permissions model for the hundredth time. Or whatever your pet thing is…</p>

<p>You may not always be pressing many keys and causing an implementation to occur, but for the people who are you're a valuable asset. You help them do it better. You help them avoid the pitfalls and mistakes you've already made five times in your career.</p>

<p>This work is vital to the health of an organization. It has a direct impact on productivity and happiness. You are helping each team member avoid pain, and you're helping the organization avoid pain. How is this a force multiplier? The evidence is proven over time.</p>

<p>Applying the skill of technical leadership is a force multiplier in several ways. <strong>If any of the following apply to you, you might be a tech lead:</strong></p>

<ul>
  <li>Your experience helps engineers at all skill levels create solutions that last longer, are easier to maintain, and respond to change better. </li>
  <li>You've thought through integration problems so there are fewer surprises. </li>
  <li>You understand the long-term goals for the software so your short-term solutions don't paint everyone into an architectural corner. </li>
  <li>Your team is constantly learning from you so retention rates are high because everyone is growing. </li>
  <li>When a customer is upset you can code up a solution which keeps the team focused on their planned work. </li>
  <li>You've been planning ahead for the next big development effort — have five prototypes ready for comment by the time the team is ready — so nobody feels lost in the face of a new challenge.</li>
</ul>

<p>This is how a technical leader is a force multiplier: enhancing the attributes of your organization to make it more effective than others. It's like skill boosts in role-playing games (be honest, if you're reading this you know exactly what I mean).</p>

<h2 id="lead-by-example">Lead by example.</h2>

<p>Technical leadership is the role best suited for my skill set. I was fortunate enough to have been supported by a fantastic people manager at my current company. With support I used everything in my technical leadership toolbox to build teams of outstanding engineers, create a culture for them to thrive in, write the story of our next great architectural revolution, and lead the team down that path.</p>

<p>I love this work. I'm passionate about it. As a programmer who always wants to code, I don't get to do it as much as I'd like, but when when I do it's usually pairing with someone on my team. As a leader I get to work directly on the problems getting in the way of my team, very real people-problems, and resolve them. I do that with the support of people management.</p>

<p>One of the core values in <a href="/work-with-us-at-whitehat/">my team culture</a> is transparency. I'll exercise that by sharing a piece of my self evaluation from last fall. It's the part where I'm supposed to say what I ought to work on for the next year. This is a high-level view of my approach to technical leadership:</p>

<blockquote>
  <h3 id="what-should-the-focus-be-for-the-next-review-period">What should the focus be for the next review period?</h3>

  <p>I'd will continue to focus on the areas I feel are the greatest value to WhiteHat. This has been my focus for the last year and will remain so. Specifically:</p>

  <p><strong>Empower Others</strong> — I will continue to create space and opportunity for the members of my team, my organization, and anyone in the company to contribute at their best level.</p>

  <p><strong>Challenge Assumptions</strong> — I will continue to challenge the things we do, how we do them, and why we do them in a relentless effort to eliminate waste in our organization.</p>

  <p><strong>Eliminate Pain Points</strong> — I will continue to learn about others' work in order to find resolution for things that are difficult and painful in their daily work. I will empower my team to find ways to automate most of those pain points away, or challenge assumptions in our process and workflow which may have created them.</p>

  <p><strong>Influence Culture</strong> — I will continue to be the change I want to see at WhiteHat, and be myself with no bad politics or hidden agendas, in order to help create the culture of trust, learning, productivity, fun, and reward I want to work in; that I want to recruit my friends to work in.</p>

  <p><strong>Lead Technology and Architecture</strong> — I will continue to be a leader, mentor, and teacher to my team members and organization members. I will take an active role in leading the development and design of our software and operational architectures to ensure we make aggressive strides toward modern, sustainable solutions that meet our customers' needs.</p>

  <p>By this time next year I will have been successful if the Engineering organization is delivering high quality software that delights our customers.</p>

  <p>I expect my team to have delivered an infrastructure and web application framework that puts us in the position to aggressively compete in our market, to have delivered several key features which empower WhiteHat to make impressive advancements within our industry and in comparison to our key competitors.</p>
</blockquote>

<h2 id="we-need-a-tech-leadership-track">We need a tech leadership track.</h2>

<p><span class="pullquote-left" data-pullquote="This is how you make technical leadership just as important as people management.">
I'm sure you've heard this before: <em>"we're going to put you on the management track."</em> The management track is a career advancement concept designed to mold high performers into managers. Within engineering we need a new, parallel track. We need a technical leadership track.</span></p>

<p>Top performers who want to remain technical and advance their career should have the option. Organizations are in desperate need of highly qualified, deeply experienced leaders making strategic decisions for the health of their software. A technical leadership track is the best way to source that talent from within.</p>

<p><strong>If you are a mid to senior level engineer</strong> right now, and you don't want to advance to management, I want to encourage you to advance to technical leadership instead. Insist on a promotion to Lead Engineer, then Architect, then Principal Architect.</p>

<p><strong>If you run an engineering department</strong> and want to offer career advancement that keeps your top performers engaged and happy, don't force them into management. Create an advancement track designed to build a strong technical leadership pipeline. Your software will be better for it.</p>

<p>Find your best technologist and promote them to Director of Architecture. Your new Director should have people managers in her peer group. This creates space for the tech leaders in your organization to grow. Build your technical leadership team under her in the hierarchy, but let them keep working with the teams their leading in day-to-day work. Let them continue to do what they're great at. This is how you make technical leadership just as important as people management.</p>

<figure>
    <img src="/images/for-posts/feet-up-boss.jpg" alt="It's good to be back in the shire." />
    <figcaption>
        I <strong>am not</strong> a manager but I love this mug.
    </figcaption>
</figure>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-23T00:00:00-05:00"><a href="http://caseywest.com/work-with-us-at-whitehat/">January 23, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://caseywest.com/about/" title="About Casey West">Casey West</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~7 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://caseywest.com/work-with-us-at-whitehat/" rel="bookmark" title="Work with us at WhiteHat" itemprop="url">Work with us at WhiteHat</a></h1>
    
  </header>
  <div class="entry-content">
    <p><strong>Update:</strong> We are no longer looking for new team members in Pittsburgh.</p>

<p>I work for <a href="https://whitehatsec.com">WhiteHat Security</a> and I lead a team called <a href="http://lotr.wikia.com/wiki/Shire">The Shire</a>. Our team primarily builds web applications in <a href="https://www.ruby-lang.org/en/">Ruby</a> on <a href="http://rubyonrails.org/">Rails</a> and we're based in <a href="https://www.walkscore.com/score/liberty-ave-and-smithfield-st-pittsburgh-pa-15222">downtown Pittsburgh</a>.</p>

<p>We're hiring a couple more developers to join our outstanding team. I'm fortunate enough to work with some of the best people in Pittsburgh. Bright, curious, hilarious, and they're good hackers<sup id="fnref:hackers"><a href="#fn:hackers" class="footnote">1</a></sup>, too! We're interested in talking to programmers of all levels. Don't shy away if you are interested but have limited experience. We want to hire great people who put in the effort, and <em>you</em> are hard enough to find as it is.</p>

<p>It's difficult to write a <em>"please come work with me"</em> essay so here's my plan: I'm going to tell you about our team culture, then about what we're looking for in a candidate. The method I'm using is to post our internal team culture document verbatim, and our internal job position document. They're both on our team wiki, and editable by anyone on the team.</p>

<p>If you read all this and you'd like to work with us please email me to talk about it. You can reach me at work with the following obfuscated email address:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
</pre></td>
  <td class="code"><pre>name    = <span class="string"><span class="delimiter">%w(</span><span class="content">Casey West</span><span class="delimiter">)</span></span>
company = <span class="string"><span class="delimiter">%q(</span><span class="content">WhiteHat Security</span><span class="delimiter">)</span></span>
email   = [
  name.join(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>),
  [
    company.tr(<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)[<span class="integer">0</span>..<span class="integer">10</span>], <span class="comment"># We go to 11. \o/</span>
    <span class="string"><span class="delimiter">'</span><span class="content">com</span><span class="delimiter">'</span></span>
  ].join(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>)
].join(<span class="string"><span class="delimiter">'</span><span class="content">@</span><span class="delimiter">'</span></span>).downcase

puts email
</pre></td>
</tr></table>
</div>

<p>You can also find links to me on social media on the left if you'd like to chat casually.</p>

<h1 id="shire-culture">Shire Culture</h1>

<p>The Shire operates under two guiding principles: <strong>trust</strong> and <strong>transparency</strong>. As a member of the team you are <strong>trusted to use the best ideas to do the most important work</strong>. As a team we agree to be <strong>transparent in our work, our ideas, and our struggles</strong>.</p>

<p>This means we are all accountable for the success of our work as a team. It doesn't matter what functional role you have, which skills you bring to the team when you start, or where you are located. If there's work that needs to be done we take responsibility for it, complete it, and ship it as a team.</p>

<p>If we succeed in our goals it's because we did it together. If we fail it's because we all failed together. Thankfully, failure is not terminal. We learn from it, adapt, and do better going forward.</p>

<p>This brings us to The Shire Motto: <em>If something is broken we fix it.</em></p>

<p>We don't put a ticket on another team's queue and wait around or complain. We do all the work we can to fix whatever is broken. We accept external roadblocks only when we are physically or administratively blocked, and we try to avoid those blockers in the future, too.</p>

<p>The Shire has adopted this attitude. Doing so has meant we've accumulated a wealth of knowledge about much of the WhiteHat Architecture. Everything from the hardware we run on to the way we document our APIs.</p>

<p><span class="pullquote-right" data-pullquote="We are not afraid of solving hard problems correctly, and we&apos;re not afraid to spend the time getting things right.">
We are not afraid of solving hard problems correctly, and we're not afraid to spend the time getting things right. We’re not afraid to make good change anywhere in the company with whatever the right tool for the job is: technology, knowledge, experience, culture, or even a good hearty laugh.
</span></p>

<p>With this understanding of our Shire culture it's clear to see what your role as a team member is: <strong>Get the job done. Do whatever it takes, and do it well.</strong></p>

<p>We work at WhiteHat to meet customer needs with positive business outcomes.</p>

<p>Here are some things we don't work at WhiteHat to do:</p>

<ul>
  <li>Write beautiful code.</li>
  <li>Test everything.</li>
  <li>Make it pixel perfect.</li>
  <li>Handle every edge case.</li>
  <li>Document every process.</li>
</ul>

<p><em>When we are doing well we get some of these for free, which is a wonderful thing,</em> but they are not our primary objective.</p>

<p>We don't work beyond our physical limits. Each team member should work to maintain their health and happiness, and the team should hold each other accountable for that. If someone is burning out we should encourage them to rest. Take care of yourself and each other.</p>

<p>What does this mean for you, for each team member? Lets consider it by functional team, since we already understand we're all in this together, anyway.</p>

<p><strong>Hackers</strong><sup id="fnref:hackers:1"><a href="#fn:hackers" class="footnote">1</a></sup></p>

<p>You are the expert on the software we create. You know where it is, how it's organized, how it's tested, and how it's deployed. If a problem can be solved by writing some code you know how to do that and you will. If you don't know how—no problem—you will soon. You aren't afraid of a challenge. You're courageous!</p>

<p>You know how to test what the team has created. You collaborate with other team members regularly to share knowledge and ideas, and to work together to find the best way to do the work because, after all, the team is all responsible for it.</p>

<p>When you're concerned there's a problem you raise the issue openly, trust the team to respond, and get to work fixing it with the team.</p>

<p>You help others always, especially lending support in areas of your expertise. You take care to teach others what you know so we all learn and grow.</p>

<p>You know what to do next because you follow the team's progress. If ever you don't know you will soon because you'll ask. Nobody has to give you a detailed task list, though, because you're self motivated and will dig into the next unsolved problem.</p>

<p><strong>Developers:</strong> See <strong>Hackers</strong></p>

<p><strong>Testers:</strong> See <strong>Hackers</strong></p>

<p><strong>Product Management and Design:</strong> See <strong>Hackers</strong></p>

<p><strong>Scrum Master:</strong> See <strong>Hackers</strong></p>

<p><strong>Interns:</strong> See <strong>Hackers</strong></p>

<p>These are the expectations the team has of every member. Regardless of your title or tenure this is your charge.</p>

<p><strong>Everyone on The Shire is a hacker, so happy hacking!</strong></p>

<h1 id="shire-hacker-job-description">Shire Hacker Job Description</h1>

<h2 id="about-us">About Us</h2>

<p>WhiteHat Security helps prevent website attacks by providing the most complete
Web security solution. We keep our customers safe in some of the most heavily
regulated and attacked industries out there.</p>

<p>At WhiteHat we code and have fun. We're hacker culture<sup id="fnref:hackers:2"><a href="#fn:hackers" class="footnote">1</a></sup>. We're focused on
delivering quality code every day and we do that by taking risks, staying
flexible, and moving fast. Our work is challenging and our team is passionate
about it. We're creative and dedicated.</p>

<h2 id="position-summary">Position Summary</h2>

<p>Do you want to be challenged by your job and overcome those challenges with
awesome people? If you do we want you on the team!</p>

<p>We want full stack, modern web application developers: polyglots who use the
right tool for the job. As a team member you will work on products that run our
business. We need you to passionately champion great ideas, collaborate on a
distributed team, and exercise unencumbered intellectual curiosity so we can
ship fantastic software together.</p>

<h2 id="desired-skills-and-experience">Desired Skills and Experience</h2>

<p>A qualified candidate will:</p>

<ul>
  <li>Have experience writing applications that are secure and have to scale.</li>
  <li>Have experience with responsible development practices: writing unit and functional tests as part of development; writing maintainable, well structured code thoughtfully.</li>
  <li>Be comfortable working collaboratively with distributed teams.</li>
  <li>Have some exposure to the full stack: *nix, devops, automated systems, application development, javascript, CSS, and HTML5.</li>
  <li>Be fearless: you know how to find the answer and you're not afraid to take a risk and try things that might not work.</li>
  <li>Be a scientist: collect data and make informed decisions whenever possible.</li>
</ul>

<p>An ideal candidate will also:</p>

<ul>
  <li>Love beautiful code: elegant code is often the result of elegant solutions.</li>
  <li>Have extensive hands-on experience with web application frameworks such as Ruby on Rails, Django, or Express.</li>
  <li>Contribute to open source projects and participate in technical communities.</li>
  <li>Understand distributed architectures such as data sharding, service oriented architecture (SOA), and load balancing, and know when to use them.</li>
</ul>

<p>This position will likely be filled at our headquarters in Santa Clara, or our
downtown Pittsburgh office. Remote work may be an option for an exceptional
candidate with remote work experience outside the Bay Area or Pittsburgh. Please
apply if you are an exceptional candidate!</p>

<p>Thank you for considering WhiteHat Security. When you apply please include your
GitHub user ID and tell us which open source project really excites you right
now, and why.</p>

<p><em>WhiteHat Security is an equal employment opportunity company.</em></p>

<div class="footnotes">
  <ol>
    <li id="fn:hackers">
      <p><em>"The act of engaging in activities (such as programming or other media) in a <strong>spirit of playfulness and exploration</strong> is termed hacking. However the defining characteristic of a hacker is not the activities performed themselves (e.g. programming), but the manner in which it is done: <strong>Hacking entails some form of excellence, for example exploring the limits of what is possible, thereby doing something exciting and meaningful.</strong>"</em> — <a href="https://en.wikipedia.org/wiki/Hacker_(programmer_subculture)">Hacker (programming subculture), Wikipedia</a> <a href="#fnref:hackers" class="reversefootnote">&#8617;</a> <a href="#fnref:hackers:1" class="reversefootnote">&#8617;<sup>2</sup></a> <a href="#fnref:hackers:2" class="reversefootnote">&#8617;<sup>3</sup></a></p>
    </li>
  </ol>
</div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-07T00:00:00-05:00"><a href="http://caseywest.com/responsibly-use-peek-to-inspect-rails/">January 07, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://caseywest.com/about/" title="About Casey West">Casey West</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~10 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://caseywest.com/responsibly-use-peek-to-inspect-rails/" rel="bookmark" title="Responsibly Use Peek to Inspect Rails" itemprop="url">Responsibly Use Peek to Inspect Rails</a></h1>
    
  </header>
  <div class="entry-content">
    <p>I <em>love</em> developing applications with the <a href="https://github.com/peek/peek">peek</a> gem. It's designed for development or staging environments; there are a few tricks if you don't want it on production or test environments.</p>

<p>This gem puts a little bar on your pages which gives you all sorts of helpful information about the request you just made.</p>

<p><img src="https://f.cloud.github.com/assets/79995/244991/03cee1fa-8a74-11e2-8e33-283cf1298a60.png" alt="peek screenshot" /></p>

<p>As you can see there is information about the branch you're on, performance metrics, database queries, caches, shared memory, and job queues in there. Read the documentation for <a href="https://github.com/peek/peek">peek</a> on GitHub and find the plugins that work best for you. They're excellent.</p>

<p><span class="pullquote-right" data-pullquote="I definitely don&apos;t want to install Peek on production">
The trouble is I definitely don't want to install Peek on production, or in my test environments, and the <a href="https://github.com/peek/peek/blob/master/README.md#usage">peek usage</a> instructions would, indeed, require me to do so for a few key reasons: initializers, routes, assets, and views. Using peek requires a few steps of setup in your application. Each of the areas I enumerated requires peek to be a loaded gem in the environment you're running on.
</span></p>

<p>My first attempt to work around this involved wrapping calls with a <a href="http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-defined-3F"><code>defined?</code></a> test. For example, in <code>config/routes.rb</code>:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
</pre></td>
  <td class="code"><pre>mount <span class="constant">Peek</span>::<span class="constant">Railtie</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">/peek</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="keyword">defined?</span>(<span class="constant">Peek</span>)
</pre></td>
</tr></table>
</div>

<p>To style and script peek bar you need some CSS and JavaScript assets as well, which are loaded through the asset pipeline. Problem is, if the gem isn't in your bundle those loads fail, and so does pre-compilation if you attempt it.</p>

<p>Finally, your views should be checking the <code>peek_enabled?</code> method, which is defined by peek in your <code>ApplicationController</code> class. So, for example, when rendering the peek bar itself you should be doing this:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre>body
  = render <span class="string"><span class="delimiter">'</span><span class="content">peek/bar</span><span class="delimiter">'</span></span> <span class="keyword">if</span> peek_enabled?
</pre></td>
</tr></table>
</div>

<p>Again, if peek isn't in your Bundle, such as in the production environment, this render will fail.</p>

<p>I'm not particularly enthusiastic about this situation, so here is my guide to using peek responsibly. There are enough moving parts I decided to use the Table of Contents.</p>

<ul id="markdown-toc">
  <li><a href="#gemfile"><code>Gemfile</code></a></li>
  <li><a href="#peekbar-class"><code>PeekBar</code> Class</a>    <ul>
      <li><a href="#definition">Definition</a></li>
      <li><a href="#test">Test</a></li>
      <li><a href="#initialization">Initialization</a></li>
    </ul>
  </li>
  <li><a href="#peekbarhelper-module"><code>PeekBarHelper</code> Module</a>    <ul>
      <li><a href="#definition-1">Definition</a></li>
      <li><a href="#test-1">Test</a></li>
    </ul>
  </li>
  <li><a href="#peek-initialization"><code>Peek</code> Initialization</a></li>
  <li><a href="#assets">Assets</a>    <ul>
      <li><a href="#css-and-javascript-definition">CSS and JavaScript Definition</a></li>
      <li><a href="#initialization-1">Initialization</a></li>
      <li><a href="#default-assets-gotcha">Default Assets Gotcha</a></li>
    </ul>
  </li>
  <li><a href="#view-configuration">View Configuration</a></li>
  <li><a href="#finally">Finally</a></li>
</ul>

<h2 id="gemfile"><code>Gemfile</code></h2>

<p>Peek must be loaded into our environment. I'm loading it into my <code>:development</code> environment only, along with a list of Peek plugins I want to use.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
</pre></td>
  <td class="code"><pre>group <span class="symbol">:development</span> <span class="keyword">do</span>
  <span class="comment"># Peek Bar</span>
  gem <span class="string"><span class="delimiter">'</span><span class="content">peek</span><span class="delimiter">'</span></span>
  gem <span class="string"><span class="delimiter">'</span><span class="content">peek-git</span><span class="delimiter">'</span></span>
  gem <span class="string"><span class="delimiter">'</span><span class="content">peek-gc</span><span class="delimiter">'</span></span>
  gem <span class="string"><span class="delimiter">'</span><span class="content">peek-performance_bar</span><span class="delimiter">'</span></span>
  gem <span class="string"><span class="delimiter">'</span><span class="content">peek-pg</span><span class="delimiter">'</span></span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<h2 id="peekbar-class"><code>PeekBar</code> Class</h2>

<p>This class is meant to answer two questions:</p>

<ol>
  <li><em>Is <code>Peek</code> available for use?</em> This question is asked when we start and configure the application.</li>
  <li><em>Should peek be enabled for this request?</em> This question is asked during requests. Specifically during view rendering for any view that incorporates peek, which is most likely a layout.</li>
</ol>

<h3 id="definition">Definition</h3>

<p>I put this class in <code>lib/peek_bar.rb</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
</pre></td>
  <td class="code"><pre><span class="keyword">class</span> <span class="class">PeekBar</span>
  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">available?</span>
    !<span class="keyword">defined?</span>(<span class="constant">Peek</span>).nil?
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">enabled?</span>(current_user)
    <span class="keyword">return</span> <span class="predefined-constant">false</span> <span class="keyword">unless</span> available?

    <span class="comment"># The default test.</span>
    <span class="string"><span class="delimiter">%w(</span><span class="content">development staging</span><span class="delimiter">)</span></span>.include? <span class="constant">Rails</span>.env
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<p>Here you can see we've encapsulated the <code>defined?</code> test into <code>PeekBar.available?</code>. We use it in <code>PeekBar.enabled?</code> as the first test.</p>

<p>If peek is available, and we're in development or the <code>current_user</code> likes nerdy toys we enable peek.</p>

<h3 id="test">Test</h3>

<p>I use <a href="https://relishapp.com/rspec/rspec-rails/docs">rspec</a> for testing, so my spec is in <code>spec/lib/peek_bar_spec.rb</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
<a href="#n14" name="n14">14</a>
<a href="#n15" name="n15">15</a>
<a href="#n16" name="n16">16</a>
<a href="#n17" name="n17">17</a>
<a href="#n18" name="n18">18</a>
<a href="#n19" name="n19">19</a>
<strong><a href="#n20" name="n20">20</a></strong>
<a href="#n21" name="n21">21</a>
<a href="#n22" name="n22">22</a>
<a href="#n23" name="n23">23</a>
<a href="#n24" name="n24">24</a>
<a href="#n25" name="n25">25</a>
<a href="#n26" name="n26">26</a>
<a href="#n27" name="n27">27</a>
<a href="#n28" name="n28">28</a>
<a href="#n29" name="n29">29</a>
<strong><a href="#n30" name="n30">30</a></strong>
<a href="#n31" name="n31">31</a>
<a href="#n32" name="n32">32</a>
<a href="#n33" name="n33">33</a>
</pre></td>
  <td class="code"><pre>require <span class="string"><span class="delimiter">'</span><span class="content">rails_helper</span><span class="delimiter">'</span></span>

<span class="constant">RSpec</span>.describe <span class="constant">PeekBar</span> <span class="keyword">do</span>
  subject { described_class }

  context <span class="string"><span class="delimiter">'</span><span class="content">without Peek</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    before(<span class="symbol">:each</span>) <span class="keyword">do</span>
      <span class="constant">Object</span>.send(<span class="symbol">:remove_const</span>, <span class="symbol">:Peek</span>) <span class="keyword">if</span> <span class="keyword">defined?</span>(<span class="constant">Peek</span>)
    <span class="keyword">end</span>

    it <span class="string"><span class="delimiter">&quot;</span><span class="content">isn't available</span><span class="delimiter">&quot;</span></span> <span class="keyword">do</span>
      expect(subject.available?).to be(<span class="predefined-constant">false</span>)
    <span class="keyword">end</span>

    it <span class="string"><span class="delimiter">&quot;</span><span class="content">isn't enabled</span><span class="delimiter">&quot;</span></span> <span class="keyword">do</span>
      expect(subject.enabled?(anything)).to be(<span class="predefined-constant">false</span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  context <span class="string"><span class="delimiter">'</span><span class="content">with Peek</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    before(<span class="symbol">:each</span>) { <span class="constant">Peek</span> = <span class="constant">Class</span>.new }
    after(<span class="symbol">:each</span>) { <span class="constant">Object</span>.send(<span class="symbol">:remove_const</span>, <span class="symbol">:Peek</span>) }

    it <span class="string"><span class="delimiter">'</span><span class="content">is available</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
      expect(subject.available?).to be(<span class="predefined-constant">true</span>)
    <span class="keyword">end</span>

    it <span class="string"><span class="delimiter">'</span><span class="content">is enabled</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
      allow(<span class="constant">Rails</span>.env).to receive(<span class="symbol">:development?</span>).and_return(<span class="predefined-constant">true</span>)
      expect(subject.enabled?(anything)).to be(<span class="predefined-constant">true</span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<p>In order to ensure this test is isolated I take extra precautions to ensure the <code>Peek</code> constant isn't available to my tests unless I explicitly allow it.</p>

<h3 id="initialization">Initialization</h3>

<p>By default Rails doesn't load ruby code from the <code>lib/</code> directory, so lets be sure to tell it to. In <code>config/application.rb</code> add this:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre>config.autoload_paths += <span class="string"><span class="delimiter">%W(</span><span class="content">
  </span><span class="inline"><span class="inline-delimiter">#{</span>config.root<span class="inline-delimiter">}</span></span><span class="content">/lib
</span><span class="delimiter">)</span></span>
</pre></td>
</tr></table>
</div>

<h2 id="peekbarhelper-module"><code>PeekBarHelper</code> Module</h2>

<p>As I said earlier peek implements a <code>peek_enabled?</code> method and suggests if you want to customize it define the method in your <code>ApplicationController</code> class. I recommend doing that in a helper class instead.</p>

<p>We need to know if peek should be enabled and to verify that we also need to know if it's available. With the <code>PeekBar</code> class this is simple.</p>

<h3 id="definition-1">Definition</h3>

<p>In <code>app/helpers/peek_bar_helper.rb</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
</pre></td>
  <td class="code"><pre><span class="keyword">module</span> <span class="class">PeekBarHelper</span>
  <span class="comment"># Typical Peek Integration</span>
  <span class="keyword">def</span> <span class="function">peek_enabled?</span>
    <span class="constant">PeekBar</span>.enabled?(current_user)
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<h3 id="test-1">Test</h3>

<p>Since we're programming responsibly here's a test for the helper. In <code>spec/helpers/peek_bar_helper_spec.rb</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
<a href="#n14" name="n14">14</a>
<a href="#n15" name="n15">15</a>
<a href="#n16" name="n16">16</a>
<a href="#n17" name="n17">17</a>
</pre></td>
  <td class="code"><pre>require <span class="string"><span class="delimiter">'</span><span class="content">rails_helper</span><span class="delimiter">'</span></span>

<span class="constant">RSpec</span>.describe <span class="constant">PeekBarHelper</span>, <span class="key">type</span>: <span class="symbol">:helper</span> <span class="keyword">do</span>
  before(<span class="symbol">:each</span>) <span class="keyword">do</span>
    allow(helper).to receive(<span class="symbol">:current_user</span>).and_return(anything)
  <span class="keyword">end</span>

  it <span class="string"><span class="delimiter">'</span><span class="content">is not enabled</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    allow(<span class="constant">PeekBar</span>).to receive(<span class="symbol">:enabled?</span>).and_return(<span class="predefined-constant">false</span>)
    expect(helper.peek_enabled?).to be(<span class="predefined-constant">false</span>)
  <span class="keyword">end</span>

  it <span class="string"><span class="delimiter">'</span><span class="content">is enabled</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    allow(<span class="constant">PeekBar</span>).to receive(<span class="symbol">:enabled?</span>).and_return(<span class="predefined-constant">true</span>)
    expect(helper.peek_enabled?).to be(<span class="predefined-constant">true</span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<h2 id="peek-initialization"><code>Peek</code> Initialization</h2>

<p>The peek documentation explains how to set up <code>config/initializers/peek.rb</code> to enable the plugins you've selected. We need to first test for the availability of peek like this:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span> <span class="constant">PeekBar</span>.available?
  <span class="constant">Peek</span>.into <span class="constant">Peek</span>::<span class="constant">Views</span>::<span class="constant">Git</span>
  <span class="constant">Peek</span>.into <span class="constant">Peek</span>::<span class="constant">Views</span>::<span class="constant">GC</span>
  <span class="constant">Peek</span>.into <span class="constant">Peek</span>::<span class="constant">Views</span>::<span class="constant">PerformanceBar</span>
  <span class="constant">Peek</span>.into <span class="constant">Peek</span>::<span class="constant">Views</span>::<span class="constant">PG</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<h2 id="assets">Assets</h2>

<p>We don't want to load or pre-compile the peek assets unless we intend to use them. My recommended approach is to wrap their inclusion in a new set of CSS and JavaScript files. I use the asset pipeline, so that's how I'll be including the gem's assets.</p>

<h3 id="css-and-javascript-definition">CSS and JavaScript Definition</h3>

<p>CSS is in <code>app/assets/stylesheets/peek_bar.scss</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
</pre></td>
  <td class="code"><pre>//= <span class="tag">require</span> <span class="tag">peek</span>
//= <span class="tag">require</span> <span class="tag">peek</span>/<span class="tag">views</span>/<span class="tag">performance_bar</span>

// <span class="tag">Peek</span> <span class="tag">bar</span> <span class="tag">on</span> <span class="tag">bottom</span> <span class="tag">of</span> <span class="tag">page</span>.
<span class="id">#peek</span> {
  <span class="key">position</span>: <span class="value">fixed</span>;
  <span class="key">bottom</span>:   <span class="float">0</span>;
  <span class="key">left</span>:     <span class="float">0</span>;
  <span class="key">right</span>:    <span class="float">0</span>;
  <span class="key">z-index</span>:  <span class="float">999</span>;
}
</pre></td>
</tr></table>
</div>

<p>I prefer <a href="http://coffeescript.org/">CoffeeScript</a> so I loaded the JavaScript in <code>app/assets/javascripts/peek_bar.js.coffee</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
</pre></td>
  <td class="code"><pre>#= require peek
#= require peek/views/performance_bar
</pre></td>
</tr></table>
</div>

<h3 id="initialization-1">Initialization</h3>

<p>The asset pipeline complains if you don't tell it about additional assets you intend to include separately (see the next section on <a href="#view-configuration">View Configuration</a>). Thing is, we don't <em>always</em> intend to include them or pre-compile them in this case. Just like when we initialized peek itself we must check for its availability.</p>

<p>Add this to <code>config/initializers/assets.rb</code>:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre><span class="keyword">if</span> <span class="constant">PeekBar</span>.available?
  <span class="constant">Rails</span>.application.config.assets.precompile += <span class="string"><span class="delimiter">%w(</span><span class="content">peek_bar.css peek_bar.js</span><span class="delimiter">)</span></span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<h3 id="default-assets-gotcha">Default Assets Gotcha</h3>

<p>By default <code>application.css</code> and <code>application.js</code> include all the CSS and JavaScript in their respective directory trees. That's achieved through the use of <code>require_tree .</code> in each of those files.</p>

<p>Now that we've created a couple assets to conditionally load we need to remove <code>require_tree</code>. If you don't remove it your default assets will try to include <code>peek_bar.*</code> which will lead to the aforementioned failures on environments where peek is not installed.</p>

<p>If you were relying on it, which I don't recommend for reasons beyond the scope of this essay, learn how to deal with it by reading the <a href="http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives">Asset Pipeline Rails Guide</a>.</p>

<h2 id="view-configuration">View Configuration</h2>

<p>All this hard work for what? Now it's time to tie it all together in our layout view. I like <a href="http://slim-lang.com/">slim</a> so this is an extremely condensed version of my default layout, <code>app/views/layouts/application.html.slim</code>.</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
<a href="#n12" name="n12">12</a>
<a href="#n13" name="n13">13</a>
</pre></td>
  <td class="code"><pre>doctype html
html
  head
    = stylesheet_link_tag <span class="string"><span class="delimiter">'</span><span class="content">application</span><span class="delimiter">'</span></span>, <span class="key">media</span>: <span class="string"><span class="delimiter">'</span><span class="content">all</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">data-turbolinks-track</span><span class="delimiter">'</span></span> =&gt; <span class="predefined-constant">true</span>
    - <span class="keyword">if</span> peek_enabled?
      = stylesheet_link_tag <span class="string"><span class="delimiter">'</span><span class="content">peek_bar</span><span class="delimiter">'</span></span>, <span class="key">media</span>: <span class="string"><span class="delimiter">'</span><span class="content">all</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">data-turbolinks-track</span><span class="delimiter">'</span></span> =&gt; <span class="predefined-constant">true</span>
    = csrf_meta_tags
body
  = render <span class="string"><span class="delimiter">'</span><span class="content">peek/bar</span><span class="delimiter">'</span></span> <span class="keyword">if</span> peek_enabled?
  = <span class="keyword">yield</span>
  = javascript_include_tag <span class="string"><span class="delimiter">'</span><span class="content">application</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">data-turbolinks-track</span><span class="delimiter">'</span></span> =&gt; <span class="predefined-constant">true</span>
  - <span class="keyword">if</span> peek_enabled?
    = javascript_include_tag <span class="string"><span class="delimiter">'</span><span class="content">peek_bar</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">data-turbolinks-track</span><span class="delimiter">'</span></span> =&gt; <span class="predefined-constant">true</span>
</pre></td>
</tr></table>
</div>

<h2 id="finally">Finally</h2>

<p>Voila!</p>

<p>At this point <a href="https://github.com/peek/peek">peek</a> is incorporated into my application in a robust, responsible way. Environments we didn't install it into operate perfectly without it, and the ones we do have an encapsulation to use for managing its inclusion in our interface.</p>

<p>It was a little more work but it paid off. We have an excellent developer tool installed without hurting production.</p>

<p>If we want to use peek in production with only staff accounts, for example, all we have to do is change the <code>Gemfile</code> to install peek in the <code>:production</code> group and adjust the <code>PeekBar.enabled?</code> method:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
</pre></td>
  <td class="code"><pre><span class="keyword">def</span> <span class="predefined-constant">self</span>.<span class="function">enabled?</span>(current_user)
  <span class="keyword">return</span> <span class="predefined-constant">false</span> <span class="keyword">unless</span> available?

  <span class="constant">Rails</span>.env.development? || current_user.staff?
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div>

<p>That <code>PeekBar</code> class really tied the room together, did it not?</p>

<iframe width="560" height="315" src="http://www.youtube.com/embed/ezQLP1dj_t8" allowfullscreen=""></iframe>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-01-06T00:00:00-05:00"><a href="http://caseywest.com/faster-ci-on-travis-and-docker-for-ruby-and-rails-and-rubocop/">January 06, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://caseywest.com/about/" title="About Casey West">Casey West</a></span></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://caseywest.com/faster-ci-on-travis-and-docker-for-ruby-and-rails-and-rubocop/" rel="bookmark" title="Faster CI on Travis (and Docker) for Ruby (and Rails (and RuboCop))" itemprop="url">Faster CI on Travis (and Docker) for Ruby (and Rails (and RuboCop))</a></h1>
    
  </header>
  <div class="entry-content">
    <p>If you read <a href="/run-bundle-audit-from-rake/">my post on running bundle-audit from rake</a> you'll also know I run <a href="https://github.com/bbatsov/rubocop">RuboCop</a> as part of continuous integration in <a href="https://travis-ci.org">Travis CI</a>. Today I switched a project to run on Travis' <a href="http://blog.travis-ci.com/2014-12-17-faster-builds-with-container-based-infrastructure/">new docker infrastructure</a> and something hilarious happened.</p>

<h1 id="running-travis-ci-on-docker">Running Travis CI on Docker</h1>

<p>This part is super easy. Amazingly easy. Add this to your <code>.travis.yml</code> file:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
</pre></td>
  <td class="code"><pre><span class="comment"># Docker Infrastructure</span>
<span class="key">sudo</span>: <span class="string"><span class="content">false</span></span>
<span class="key">cache</span>: <span class="string"><span class="content">bundler</span></span>
</pre></td>
</tr></table>
</div>

<p>The <code>sudo</code> key is the magic word to build your project in a Docker container. The <code>cache</code> key will enable <a href="http://bundler.io/">bundler</a> caching for your project.</p>

<p>These two lines can speed up your build times by nearly eliminating startup costs. I went from 2.5 minutes to 24 seconds on builds which used the cache and archived images. I'm running <code>bundle-audit</code>, <code>brakeman</code>, <code>rubocop</code>, and <code>rspec</code> in 24 seconds. That is awesome!</p>

<h1 id="the-funny-thing-is">The funny thing is…</h1>

<p>The first run I had a little hiccup. <a href="https://github.com/bbatsov/rubocop">RuboCop</a> was doing its thing and, on this project, it only has 30 files to inspect. I know that because I just ran it locally and, yep, 30 files. In the Travis environment, however, it was scanning <strong>5320 files</strong>. That's probably wrong.</p>

<p><span class="pullquote-right" data-pullquote="by enabling the `cache` in Travis I caused RuboCop to lose its mind">
Turns out, by enabling the <code>cache</code> in Travis I caused RuboCop to lose its mind. How? Because of where the cache was stored. Travis put the cache in <code>vendor/bundle</code> which is in my Rails app directory and within sight of RuboCop. That's legit, but I don't actually want RuboCop to check any vendor code.
</span></p>

<p>Why was RuboCop doing that? Because I wanted to <code>Exclude</code> a few things in my Rails app—mostly generated code—so I had a <code>.rubocop.yml</code> file that looked a little like this:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
</pre></td>
  <td class="code"><pre><span class="key">require</span>: <span class="string"><span class="content">rubocop-rspec</span></span>
<span class="key">inherit_from</span>: <span class="string"><span class="content">.rubocop_todo.yml</span></span>
<span class="key">AllCops</span>:
  <span class="key">Exclude</span>:
    - <span class="string"><span class="content">'db/schema.rb'</span></span>
    - <span class="string"><span class="content">'bin/**/*'</span></span>
    - <span class="string"><span class="content">'config/initializers/devise.rb'</span></span>
    - <span class="string"><span class="content">'config/initializers/simple_form*'</span></span>
    - <span class="string"><span class="content">'db/migrate/*'</span></span>
  <span class="key">RunRailsCops</span>: <span class="string"><span class="content">true</span></span>
</pre></td>
</tr></table>
</div>

<p>The <a href="https://github.com/bbatsov/rubocop/blob/master/config/default.yml#L28">default RuboCop configuration</a> <em>does</em> exclude vendor. I need that, too, but my <code>Exclude</code> above overrides the default, so it was gone.</p>

<h1 id="the-simple-fix">The simple fix</h1>

<p>Lets just add <code>vendor</code> back into the exclusion list:</p>

<div class="highlighter-coderay"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
<a href="#n6" name="n6">6</a>
<a href="#n7" name="n7">7</a>
<a href="#n8" name="n8">8</a>
<a href="#n9" name="n9">9</a>
<strong><a href="#n10" name="n10">10</a></strong>
<a href="#n11" name="n11">11</a>
</pre></td>
  <td class="code"><pre><span class="key">require</span>: <span class="string"><span class="content">rubocop-rspec</span></span>
<span class="key">inherit_from</span>: <span class="string"><span class="content">.rubocop_todo.yml</span></span>
<span class="key">AllCops</span>:
  <span class="key">Exclude</span>:
    - <span class="string"><span class="content">'db/schema.rb'</span></span>
    - <span class="string"><span class="content">'bin/**/*'</span></span>
    - <span class="string"><span class="content">'config/initializers/devise.rb'</span></span>
    - <span class="string"><span class="content">'config/initializers/simple_form*'</span></span>
    - <span class="string"><span class="content">'db/migrate/*'</span></span>
    - <span class="string"><span class="content">'vendor/**/*'</span></span>
  <span class="key">RunRailsCops</span>: <span class="string"><span class="content">true</span></span>
</pre></td>
</tr></table>
</div>

<p>Voila!</p>

<p>Be careful when modifying RuboCop's configuration that you copy what you need to keep from the defaults, because defining an entry in your project will discard the them, not merge them.</p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    
      <a href="http://caseywest.com" class="btn">Previous</a>
    
  
  <ul class="inline-list">
    <li>
      
        <a href="http://caseywest.com">1</a>
      
    </li>
    
      <li>
        
          <span class="current-page">2</span>
        
      </li>
    
      <li>
        
          <a href="http://caseywest.com/page3">3</a>
        
      </li>
    
      <li>
        
          <a href="http://caseywest.com/page4">4</a>
        
      </li>
    
  </ul>
  
    <a href="http://caseywest.com/page3" class="btn">Next</a>
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <p><span>&copy; 2015 Casey West.</span></p>
<p class="attribution"><span>Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/" rel="notfollow">HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://caseywest.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://caseywest.com/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57986008-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>




<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</body>
</html>
